machine:
  services:
    - docker

dependencies:
  override:
    - docker info
    - docker pull typesafety/typesafety:latest
    - docker run --rm -v "$(pwd)":"$(pwd)" --workdir="$(pwd)" typesafety/typesafety:latest composer install

test:
  override:
    - docker run -v "$(pwd)":"$(pwd)" --workdir="$(pwd)" -e "CIRCLE_TEST_REPORTS=$CIRCLE_TEST_REPORTS" typesafety/typesafety:latest hhvm -c test/self-test.ini test/self-test.php
